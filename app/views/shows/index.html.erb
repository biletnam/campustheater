<% content_for :body_tag_content do %>
	 data-spy="scroll" data-target="#nav-shows" data-offset="140"
<% end %>

<% content_for :head do %>
	<script>
		var show_showtimes = <%= raw @showtime_data.to_json %>;
	</script>
<% end %>

<nav id="nav-shows" class="navbar scroll-fixed-top">
  <div class="navbar-inner">
    <ul class="nav nav-pills">
      <li><a href="#opening">Opening Soon</a></li>
      <li><a href="#this_semester"><%= oci_id_to_text(current_oci_id) %></a></li>
      <li><a href="#next_semester"><%= oci_id_to_text(next_oci_id) %></a></li>
      
      <% (2008..Time.now.year).to_a.reverse.each do |year| %>
		<li><a href="#<%= year.to_s + (year == Time.now.year && Time.now.month < 8 ? "01" : "03") %>"><%= year %></a></li>
	  <% end %>
	  <li><a href="#ancient">Ancient</a></li>
    </ul>
  </div>
</nav>


<div class="divider" id="opening">
	<h3>Opening Soon</h3>
</div>
<div class="this_week">
	<% @this_week.in_groups_of(4, false) do |items| %>
		<div class="row">
			<% items.each do |item| %>
				<div class="span3 item clearfix">
					<%= render :partial => 'shared/show_frontpage', :locals => { :show => item, :row_count => 4, :color_palette => item.accent_color ? item.accent_color.to_s : cycle("red", "blue","yellow","black","dark_blue","green", "light_blue") } %>
				</div>
			<% end %>
		</div>
	<% end %>
</div>

<div class="divider" id="this_semester">
	<h3>This Semester</h3>
</div>
<% @this_semester.in_groups_of(3, false) do |items| %>
	<div class="row">
		<% items.each do |item| %>
			<%= render :partial => 'shared/show_with_thumbnail', :locals => { :show => item, :row_count => items.length, :color_palette => item.accent_color ? item.accent_color.to_s : cycle("red", "blue","yellow","black","dark_blue","green", "light_blue") } %>
		<% end %>
	</div>
<% end %>


<div class="divider" id="next_semester">
	<h3>Beyond</h3>
</div>
<% @other.in_groups_of(3, false) do |items| %>
	<div class="row">
		<% items.each do |item| %>
			<%= render :partial => 'shared/show_with_thumbnail', :locals => { :show => item, :row_count => items.length, :color_palette => item.accent_color ? item.accent_color.to_s : cycle("red", "blue","yellow","black","dark_blue","green", "light_blue") } %>
		<% end %>
	</div>
<% end %>

</div>
<!-- End of #main -->
<div id="archives">
	<div class="container shows index">

	<% (2008..Time.now.year).to_a.reverse.each do |year| %>
		<% ["03","01"].each do |term| %>
			<% if Time.now.year == year && Time.now.month < 7 && !Show.term_to_range("#{year}#{term}").cover?(Time.now) %>

			<% elsif year == Time.now.year && Show.term_to_range("#{year}#{term}").cover?(Time.now) %>
				<% cache({:action => "index", :action_suffix => "#{year}#{term}"}, {:expires_in => 12.hours}) do %>
					<%= render :partial => "shows/archives", :locals => {:term => "#{year}#{term}"} %>
				<% end %>
			<% else %>
				<% cache(:action => "index", :action_suffix => "#{year}#{term}") do %>
					<%= render :partial => "shows/archives", :locals => {:term => "#{year}#{term}"} %>
				<% end %>
			<% end %>
		<% end %>
	<% end %>
	<%= render :partial => "shows/archives", :locals => {:term => "ancient"} %>
	</div>